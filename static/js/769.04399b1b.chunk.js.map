{"version":3,"file":"static/js/769.04399b1b.chunk.js","mappings":"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","sources":["components/chat/ChatBox.js","components/chat/AllChats.js","pages/Chat.js"],"sourcesContent":["import React from 'react';\r\nimport { Link, useLocation } from 'react-router-dom';\r\nimport { image_url } from '../../utils/constants';\r\nimport photocamera from '../../assets/ICONs/photocamera.png';\r\nimport { useUserContext } from '../../contexts/UserProvider';\r\nimport { useSellerCalledContext } from '../../contexts/CalledSellerProvider';\r\nimport { doc, updateDoc } from 'firebase/firestore';\r\nimport { db } from '../../firebase';\r\nconst ChatBox = ({ chats }) => {\r\n  const { userInfo, setIsClickedFunc } = useUserContext();\r\n  const { chatId, dispatch } = useSellerCalledContext();\r\n  const { pathname } = useLocation();\r\n\r\n  const handleSelectSeller = async (u, name, image, phone) => {\r\n    if (chatId) {\r\n      await updateDoc(doc(db, 'userChats', userInfo.id), {\r\n        [chatId + '.isRead']: 'true',\r\n      });\r\n    }\r\n    dispatch({\r\n      type: 'CHANGE_USER',\r\n      payload: u,\r\n      payload2: name,\r\n      payload3: image,\r\n      payload4: phone,\r\n    });\r\n    await updateDoc(doc(db, 'userChats', userInfo.id), {\r\n      [`${userInfo.id > u ? userInfo.id + u : u + userInfo.id}` + '.isRead']:\r\n        'true',\r\n    });\r\n  };\r\n  return (\r\n    <>\r\n      {chats &&\r\n        chats.length > 0 &&\r\n        chats\r\n          .sort((a, b) => b[1].date - a[1].date)\r\n          .map((chat) => {\r\n            return (\r\n              <div key={chat[0]}>\r\n                {chat[1].lastMessage?.text && (\r\n                  <Link\r\n                    className='box text-decoration-none bg-light rounded mx-1 text-primary d-flex justify-content-between flex-column flex-sm-row py-3 mt-3'\r\n                    to={`/chat/user/${chat[1].sellerInfo.id}`}\r\n                    onClick={() => {\r\n                      handleSelectSeller(\r\n                        chat[1].sellerInfo.id,\r\n                        chat[1].sellerInfo.name,\r\n                        chat[1].sellerInfo.image,\r\n                        chat[1].sellerInfo.phone\r\n                      );\r\n                      setIsClickedFunc(true);\r\n                    }}\r\n                    key={chat[0]}\r\n                  >\r\n                    <div className='d-flex align-items-center'>\r\n                      <img\r\n                        src={`${image_url}${chat[1].sellerInfo.image}`}\r\n                        alt='person'\r\n                        className='avatar rounded-circle mx-2'\r\n                      />\r\n                      <div className='mx-3'>\r\n                        <h4>{chat[1].sellerInfo.name}</h4>\r\n                        {chat[1].lastMessage?.text &&\r\n                        chat[1].lastMessage?.text == 'صورة' ? (\r\n                          <>\r\n                            <span\r\n                              className={`${\r\n                                chat[1]?.isRead == 'true' ||\r\n                                (chat[0] == chatId && pathname.includes('user'))\r\n                                  ? 'fw-lighter text-muted'\r\n                                  : 'fw-semibold fs-6'\r\n                              }`}\r\n                            >\r\n                              {chat[1].lastMessage?.text}\r\n                            </span>\r\n                            <img\r\n                              src={photocamera}\r\n                              alt=''\r\n                              className='chat-icon'\r\n                            />\r\n                          </>\r\n                        ) : (\r\n                          <span\r\n                            className={`${\r\n                              chat[1]?.isRead == 'true' ||\r\n                              (chat[0] == chatId && pathname.includes('user'))\r\n                                ? 'fw-lighter text-muted'\r\n                                : 'fw-semibold fs-6'\r\n                            }`}\r\n                          >\r\n                            {chat[1].lastMessage?.text &&\r\n                            chat[1].lastMessage.text.length <= 20\r\n                              ? chat[1].lastMessage?.text\r\n                              : `${chat[1].lastMessage.text.slice(0, 20)}...`}\r\n                          </span>\r\n                        )}\r\n                      </div>\r\n                    </div>\r\n                  </Link>\r\n                )}\r\n              </div>\r\n            );\r\n          })}\r\n    </>\r\n  );\r\n};\r\n\r\nexport default ChatBox;\r\n","import React from 'react';\n\nimport { doc, onSnapshot, updateDoc } from 'firebase/firestore';\nimport { db } from '../../firebase';\nimport { useUserContext } from '../../contexts/UserProvider';\nimport { useState } from 'react';\nimport { useEffect } from 'react';\nimport ChatBox from './ChatBox';\nimport { useLocation } from 'react-router-dom';\n// import { useUserCalledContext } from '../../contexts/CalledUserProvider';\nconst AllChats = () => {\n  const { chatRead } = useUserContext();\n  const { userInfo, handleChatRead, setIsClickedFunc } = useUserContext();\n  const makeFunc = async () => {\n    handleChatRead(false);\n    await updateDoc(doc(db, 'userChats', userInfo?.id), {\n      chatRead: false,\n    });\n  };\n  useEffect(() => {\n    chatRead && makeFunc();\n  }, [chatRead]);\n  // Rended All Chats\n  const [chats, setChats] = useState([]);\n  const [chatsReaded, setChatsReaded] = useState([]);\n  const [chatsUnReaded, setChatsUnReaded] = useState([]);\n  const [show, setShow] = useState('all');\n\n  useEffect(() => {\n    const getChats = () => {\n      const unsub = onSnapshot(doc(db, 'userChats', userInfo.id), (doc) => {\n        setChats(Object.entries(doc.data()));\n        setChatsReaded(() => {\n          const a = Object.entries(doc.data()).filter(\n            (a) => a[1]?.isRead && a[1]?.isRead == 'true'\n          );\n          return a;\n        });\n        setChatsUnReaded(() => {\n          const a = Object.entries(doc.data()).filter(\n            (a) => a[1]?.isRead && a[1]?.isRead == 'false'\n          );\n          return a;\n        });\n      });\n\n      return () => {\n        unsub();\n      };\n    };\n\n    userInfo.id && getChats();\n  }, [userInfo.id]);\n\n  // Rended All Chats\n  return (\n    <div className='all-chats bg-primary rounded py-4  overflow-auto '>\n      <div\n        className='btn-group mx-2 d-flex flex-column flex-sm-row gap-2 justify-content-center'\n        role='group'\n      >\n        <button\n          type='button'\n          className={`btn mx-3 fs-5 fw-bold ${\n            show == 'all'\n              ? 'btn-secondary text-white'\n              : 'btn-light text-primary '\n          }`}\n          onClick={() => setShow('all')}\n        >\n          الكل\n        </button>\n        <button\n          type='button'\n          className={`btn mx-3 fs-5 fw-bold ${\n            show == 'read'\n              ? 'btn-secondary text-white'\n              : 'btn-light text-primary '\n          }`}\n          onClick={() => setShow('read')}\n        >\n          مقروئة\n        </button>\n        <button\n          type='button'\n          className={`btn mx-3 fs-5 fw-bold ${\n            show == 'unread'\n              ? 'btn-secondary text-white'\n              : 'btn-light text-primary '\n          }`}\n          onClick={() => setShow('unread')}\n        >\n          غير مقروئة\n        </button>\n      </div>\n\n      <div className='border-bottom w-75 mx-auto mt-4'></div>\n      {/* chats */}\n      <div className='chats mt-3'>\n        {show == 'all' ? (\n          <ChatBox chats={chats} />\n        ) : show == 'read' ? (\n          <ChatBox chats={chatsReaded} />\n        ) : (\n          show == 'unread' && chatsUnReaded && <ChatBox chats={chatsUnReaded} />\n        )}\n      </div>\n    </div>\n  );\n};\n\nexport default AllChats;\n","import React, { useEffect, useState } from 'react';\nimport AllChats from '../components/chat/AllChats';\nimport chat from '../assets/ICONs/chat/chat.png';\nimport { useMainContext } from '../contexts/MainProvider';\nimport { useUserContext } from '../contexts/UserProvider';\nconst Chat = () => {\n  const { toggleNavbarFunc, closeSubmenu, closeSearch } = useMainContext();\n\n  const { token } = useUserContext();\n  useEffect(() => {\n    toggleNavbarFunc(false);\n    closeSubmenu(false);\n    closeSearch();\n    window.scrollTo(0, 0);\n  }, []);\n  return (\n    <main>\n      {token && (\n        <div className='chat my-3 mx-3  '>\n          <div className='row gy-2'>\n            <div className='col-lg-5'>\n              <AllChats />\n            </div>\n            <div className='col-lg-7 d-none d-lg-block'>\n              <div className='bg-primary rounded choose-chat d-flex justify-content-center align-items-center'>\n                <div>\n                  <img\n                    src={chat}\n                    alt='chat'\n                    className='chat-image '\n                    loading='lazy'\n                  />\n                  <h5 className='text-center text-white fw-bold mt-3'>\n                    اختر محادثة لعرضها\n                  </h5>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      )}\n    </main>\n  );\n};\n\nexport default Chat;\n"],"names":["_ref","chats","_useUserContext","useUserContext","userInfo","setIsClickedFunc","_useSellerCalledConte","useSellerCalledContext","chatId","dispatch","pathname","useLocation","handleSelectSeller","_ref2","_asyncToGenerator","_regeneratorRuntime","mark","_callee","u","name","image","phone","wrap","_context","prev","next","updateDoc","doc","db","id","_defineProperty","type","payload","payload2","payload3","payload4","concat","stop","_x","_x2","_x3","_x4","apply","arguments","_jsx","_Fragment","children","length","sort","a","b","date","map","chat","_chat$1$lastMessage","_chat$1$lastMessage2","_chat$1$lastMessage3","_chat$","_chat$1$lastMessage4","_chat$2","_chat$1$lastMessage5","_chat$1$lastMessage6","lastMessage","text","Link","className","to","sellerInfo","onClick","_jsxs","src","image_url","alt","isRead","includes","photocamera","slice","chatRead","_useUserContext2","handleChatRead","makeFunc","useEffect","_useState","useState","_useState2","_slicedToArray","setChats","_useState3","_useState4","chatsReaded","setChatsReaded","_useState5","_useState6","chatsUnReaded","setChatsUnReaded","_useState7","_useState8","show","setShow","unsub","onSnapshot","Object","entries","data","filter","_a$","_a$2","_a$3","_a$4","getChats","role","ChatBox","_useMainContext","useMainContext","toggleNavbarFunc","closeSubmenu","closeSearch","token","window","scrollTo","AllChats","loading"],"sourceRoot":""}