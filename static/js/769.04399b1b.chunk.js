"use strict";(self.webpackChunksouq_eg=self.webpackChunksouq_eg||[]).push([[769],{9108:function(e,t,n){n.d(t,{Z:function(){return p}});var a=n(9439),s=n(4165),r=n(5861),c=n(2791),i=n(2481),l=n(673),o=n(7837),d=n(4942),u=n(7689),f=n(1087),x=n(3585),h=n(4745),m=n(4793),v=n(184),b=function(e){var t=e.chats,n=(0,o.S)(),a=n.userInfo,c=n.setIsClickedFunc,b=(0,m.H)(),p=b.chatId,g=b.dispatch,j=(0,u.TH)().pathname,y=function(){var e=(0,r.Z)((0,s.Z)().mark((function e(t,n,r,c){return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!p){e.next=3;break}return e.next=3,(0,i.r7)((0,i.JU)(l.db,"userChats",a.id),(0,d.Z)({},p+".isRead","true"));case 3:return g({type:"CHANGE_USER",payload:t,payload2:n,payload3:r,payload4:c}),e.next=6,(0,i.r7)((0,i.JU)(l.db,"userChats",a.id),(0,d.Z)({},"".concat(a.id>t?a.id+t:t+a.id)+".isRead","true"));case 6:case"end":return e.stop()}}),e)})));return function(t,n,a,s){return e.apply(this,arguments)}}();return(0,v.jsx)(v.Fragment,{children:t&&t.length>0&&t.sort((function(e,t){return t[1].date-e[1].date})).map((function(e){var t,n,a,s,r,i,l,o;return(0,v.jsx)("div",{children:(null===(t=e[1].lastMessage)||void 0===t?void 0:t.text)&&(0,v.jsx)(f.rU,{className:"box text-decoration-none bg-light rounded mx-1 text-primary d-flex justify-content-between flex-column flex-sm-row py-3 mt-3",to:"/chat/user/".concat(e[1].sellerInfo.id),onClick:function(){y(e[1].sellerInfo.id,e[1].sellerInfo.name,e[1].sellerInfo.image,e[1].sellerInfo.phone),c(!0)},children:(0,v.jsxs)("div",{className:"d-flex align-items-center",children:[(0,v.jsx)("img",{src:"".concat(x.BU).concat(e[1].sellerInfo.image),alt:"person",className:"avatar rounded-circle mx-2"}),(0,v.jsxs)("div",{className:"mx-3",children:[(0,v.jsx)("h4",{children:e[1].sellerInfo.name}),null!==(n=e[1].lastMessage)&&void 0!==n&&n.text&&"\u0635\u0648\u0631\u0629"==(null===(a=e[1].lastMessage)||void 0===a?void 0:a.text)?(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)("span",{className:"".concat("true"==(null===(s=e[1])||void 0===s?void 0:s.isRead)||e[0]==p&&j.includes("user")?"fw-lighter text-muted":"fw-semibold fs-6"),children:null===(r=e[1].lastMessage)||void 0===r?void 0:r.text}),(0,v.jsx)("img",{src:h,alt:"",className:"chat-icon"})]}):(0,v.jsx)("span",{className:"".concat("true"==(null===(i=e[1])||void 0===i?void 0:i.isRead)||e[0]==p&&j.includes("user")?"fw-lighter text-muted":"fw-semibold fs-6"),children:null!==(l=e[1].lastMessage)&&void 0!==l&&l.text&&e[1].lastMessage.text.length<=20?null===(o=e[1].lastMessage)||void 0===o?void 0:o.text:"".concat(e[1].lastMessage.text.slice(0,20),"...")})]})]})},e[0])},e[0])}))})},p=function(){var e=(0,o.S)().chatRead,t=(0,o.S)(),n=t.userInfo,d=t.handleChatRead,u=(t.setIsClickedFunc,function(){var e=(0,r.Z)((0,s.Z)().mark((function e(){return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return d(!1),e.next=3,(0,i.r7)((0,i.JU)(l.db,"userChats",null===n||void 0===n?void 0:n.id),{chatRead:!1});case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}());(0,c.useEffect)((function(){e&&u()}),[e]);var f=(0,c.useState)([]),x=(0,a.Z)(f,2),h=x[0],m=x[1],p=(0,c.useState)([]),g=(0,a.Z)(p,2),j=g[0],y=g[1],w=(0,c.useState)([]),N=(0,a.Z)(w,2),k=N[0],C=N[1],Z=(0,c.useState)("all"),I=(0,a.Z)(Z,2),R=I[0],S=I[1];return(0,c.useEffect)((function(){n.id&&function(){var e=(0,i.cf)((0,i.JU)(l.db,"userChats",n.id),(function(e){m(Object.entries(e.data())),y((function(){return Object.entries(e.data()).filter((function(e){var t,n;return(null===(t=e[1])||void 0===t?void 0:t.isRead)&&"true"==(null===(n=e[1])||void 0===n?void 0:n.isRead)}))})),C((function(){return Object.entries(e.data()).filter((function(e){var t,n;return(null===(t=e[1])||void 0===t?void 0:t.isRead)&&"false"==(null===(n=e[1])||void 0===n?void 0:n.isRead)}))}))}))}()}),[n.id]),(0,v.jsxs)("div",{className:"all-chats bg-primary rounded py-4  overflow-auto ",children:[(0,v.jsxs)("div",{className:"btn-group mx-2 d-flex flex-column flex-sm-row gap-2 justify-content-center",role:"group",children:[(0,v.jsx)("button",{type:"button",className:"btn mx-3 fs-5 fw-bold ".concat("all"==R?"btn-secondary text-white":"btn-light text-primary "),onClick:function(){return S("all")},children:"\u0627\u0644\u0643\u0644"}),(0,v.jsx)("button",{type:"button",className:"btn mx-3 fs-5 fw-bold ".concat("read"==R?"btn-secondary text-white":"btn-light text-primary "),onClick:function(){return S("read")},children:"\u0645\u0642\u0631\u0648\u0626\u0629"}),(0,v.jsx)("button",{type:"button",className:"btn mx-3 fs-5 fw-bold ".concat("unread"==R?"btn-secondary text-white":"btn-light text-primary "),onClick:function(){return S("unread")},children:"\u063a\u064a\u0631 \u0645\u0642\u0631\u0648\u0626\u0629"})]}),(0,v.jsx)("div",{className:"border-bottom w-75 mx-auto mt-4"}),(0,v.jsx)("div",{className:"chats mt-3",children:"all"==R?(0,v.jsx)(b,{chats:h}):"read"==R?(0,v.jsx)(b,{chats:j}):"unread"==R&&k&&(0,v.jsx)(b,{chats:k})})]})}},1769:function(e,t,n){n.r(t);var a=n(2791),s=n(9108),r=n(9706),c=n(4404),i=n(7837),l=n(184);t.default=function(){var e=(0,c.H)(),t=e.toggleNavbarFunc,n=e.closeSubmenu,o=e.closeSearch,d=(0,i.S)().token;return(0,a.useEffect)((function(){t(!1),n(!1),o(),window.scrollTo(0,0)}),[]),(0,l.jsx)("main",{children:d&&(0,l.jsx)("div",{className:"chat my-3 mx-3  ",children:(0,l.jsxs)("div",{className:"row gy-2",children:[(0,l.jsx)("div",{className:"col-lg-5",children:(0,l.jsx)(s.Z,{})}),(0,l.jsx)("div",{className:"col-lg-7 d-none d-lg-block",children:(0,l.jsx)("div",{className:"bg-primary rounded choose-chat d-flex justify-content-center align-items-center",children:(0,l.jsxs)("div",{children:[(0,l.jsx)("img",{src:r,alt:"chat",className:"chat-image ",loading:"lazy"}),(0,l.jsx)("h5",{className:"text-center text-white fw-bold mt-3",children:"\u0627\u062e\u062a\u0631 \u0645\u062d\u0627\u062f\u062b\u0629 \u0644\u0639\u0631\u0636\u0647\u0627"})]})})})]})})})}},9706:function(e,t,n){e.exports=n.p+"static/media/chat.2ea981f6012083b66b8a.png"},4745:function(e,t,n){e.exports=n.p+"static/media/photocamera.9cc066fd6566bb5ee60b.png"}}]);
//# sourceMappingURL=769.04399b1b.chunk.js.map